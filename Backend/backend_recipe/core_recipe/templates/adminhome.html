{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="admin-container">

  <!-- DASHBOARD STATUS -->
  <div class="stats-grid">
    <div class="card">
      <p>Total Users</p>
      <h2>{{ total_users }}</h2>
    </div>
    <div class="card">
      <p>Total Recipes</p>
      <h2>{{ total_recipes }}</h2>
    </div>
    <div class="card">
      <p>Active Users</p>
      <h2>{{ active_users }}</h2>
    </div>
    <div class="card">
      <p>Top Recipe</p>
      <h3>{{ top_recipe }}</h3>
    </div>
  </div>


  <!-- SEARCH BAR -->
  <form method="GET" class="search-bar">
    <input 
      type="text" 
      name="q" 
      placeholder="Search recipesâ€¦" 
      value="{{ query }}"
    >
    <button type="submit">Search</button>
  </form>


  <!-- RECIPES TABLE -->
  <table class="recipe-table">
    <thead>
      <tr>
        <th>#</th>
        <th>Recipe Name</th>
        <th>Image</th>
        <th>Added By</th>
        <th>Views</th>
      </tr>
    </thead>
    <tbody>

      {% if page_obj %}
        {% for recipe in page_obj %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td>{{ recipe.recipe_name }}</td>

          <td>
            {% if recipe.image %}
              <img src="{{ recipe.image.url }}" width="70">
            {% else %}
              No Image
            {% endif %}
          </td>

          <td>{{ recipe.user.email }}</td>
          <td>{{ recipe.views }}</td>
        </tr>
        {% endfor %}
      {% else %}
        <tr>
          <td colspan="5" style="text-align:center;">No Recipes Found</td>
        </tr>
      {% endif %}

    </tbody>
  </table>


  <!-- PAGINATION -->
<div class="pagination-container">
  <div class="pagination">

    {% if page_obj.has_previous %}
      <a href="?q={{ query }}&page={{ page_obj.previous_page_number }}">Prev</a>
    {% endif %}

    <span>
      Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
    </span>

    {% if page_obj.has_next %}
      <a href="?q={{ query }}&page={{ page_obj.next_page_number }}">Next</a>
    {% endif %}

  </div>

</div>


</div>


<!-- BASIC STYLING -->
<style>

.admin-container {
  padding: 30px;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
  margin-bottom: 30px;
}

.card {
  background: linear-gradient(135deg, #1f2937, #111827);
  color: white;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0,0,0,.2);
}

.card p { opacity: 0.7; margin-bottom: 8px; }


.search-bar {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
}

.search-bar input {
  flex: 1;
  padding: 10px;
  border-radius: 6px;
  border: 1px solid #ccc;
}

.search-bar button {
  padding: 10px 18px;
  background: #2563eb;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}


.recipe-table {
  width: 100%;
  border-collapse: collapse;
}

.recipe-table th,
.recipe-table td {
  padding: 12px;
  border-bottom: 1px solid #ddd;
}

.recipe-table th {
  background: #111827;
  color: white;
  text-align: left;
}

.recipe-table tr:hover {
  background: #f3f4f6;
}


.pagination-container {
  display: flex;
  justify-content: center;
  margin-top: 25px;
}

.pagination {
  display: flex;
  align-items: center;
  gap: 15px;
}

.pagination a {
  background: #111827;
  color: white;
  padding: 8px 16px;
  border-radius: 8px;
  text-decoration: none;
  transition: 0.2s ease;
}

.pagination a:hover {
  background: #2563eb;
}

.pagination span {
  font-weight: bold;
}

</style>

{% endblock %}
