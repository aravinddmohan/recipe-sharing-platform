{% extends "base.html" %}

{% block content %}
<style>
.user-img {
    width: 45px;
    height: 45px;
    object-fit: cover;
    border-radius: 50%;
}

.action-btns a {
    margin-right: 8px;
}
</style>

<div class="container mt-5">

<h2 class="fw-bold mb-4">User Details</h2>

<div class="card shadow-sm">
<div class="card-body p-0">

<table class="table table-hover mb-0">

<thead class="table-dark">
<tr>
<th>#</th>
<th>User</th>
<th>Email</th>
<th>Last Login</th>
<th>Status</th>
<th class="text-center">Action</th>
</tr>
</thead>

<tbody>

{% for user in users %}
<tr>

<td>{{ forloop.counter }}</td>

<td>
<img src="https://i.pravatar.cc/45?u={{ user.email }}" class="user-img me-2">
{{ user.name|default:user.email }}
</td>

<td>{{ user.email }}</td>
<td>
{% if user.last_login %}
    {{ user.last_login|date:"d M Y, h:i A" }}
{% else %}
    <span class="text-muted">Never</span>
{% endif %}
</td>

<td>
{% if user.is_active %}
<span class="badge bg-success">Active</span>
{% else %}
<span class="badge bg-danger">Blocked</span>
{% endif %}
</td>

<td class="text-center action-btns">

<a href="{% url 'adminuserhistory' user.id %}" class="btn btn-sm btn-primary">
History
</a>

{% if user.is_active %}
<a href="{% url 'block_user' user.id %}" class="btn btn-sm btn-danger">
Block
</a>

{% else %}
<a href="{% url 'unblock_user' user.id %}" class="btn btn-sm btn-success">
Unblock
</a>
{% endif %}

</td>

</tr>
{% empty %}
<tr>
<td colspan="5" class="text-center p-4">No users found</td>
</tr>
{% endfor %}

</tbody>
</table>

</div>
</div>

</div>
{% endblock %}
